---
#
# Generic TLD Pattern 
#
name: generic/tld/Found02

# Use this template for catch-all parsing:
tag: catch-all

# Lines can appear out of order
outOfOrder: true

# End tokens on new lines
terminateOnNewLine: true

# Use token preamble on current line only
trimPreambleBeforeNewLine: true

# Set query response type:
set: Status = Found
---

#
# Domain
#
Domain Name: { DomainName : IsDomainName, ToLower }
Domain ID: { RegistryDomainId ? }

#
# Registration, Updated and Expiration Dates
#
Creation Date: { Registered ? : SubstringBefore("UTC"), ToDateTimeUtc("yyyy-MM-ddTHH:mm:ssZ", "yyyy-MM-ddTHH:mm:ss.fffZ", "dd-MMM-yyyy hh:mm:ss") }
Creation Date: { Registered ? : ToDateTimeUtc("yyyy-MM-ddTHH:mm:ss.fZ") }
Created On: { Registered ? : SubstringBefore("UTC"), ToDateTimeUtc("yyyy-MM-ddTHH:mm:ssZ", "yyyy-MM-ddTHH:mm:ss.fffZ", "dd-MMM-yyyy hh:mm:ss") }

Updated Date: { Updated ? : SubstringBefore("UTC"), ToDateTimeUtc("yyyy-MM-ddTHH:mm:ssZ", "yyyy-MM-ddTHH:mm:ss.fffZ", "dd-MMM-yyyy hh:mm:ss") }
Updated Date: { Updated ? : ToDateTimeUtc("yyyy-MM-ddTHH:mm:ss.fZ") }
Last Updated On: { Updated ? : SubstringBefore("UTC"), ToDateTimeUtc("yyyy-MM-ddTHH:mm:ssZ", "yyyy-MM-ddTHH:mm:ss.fffZ", "dd-MMM-yyyy hh:mm:ss") }

Registry Expiry Date: { Expiration ? : SubstringBefore("UTC"), ToDateTimeUtc("yyyy-MM-ddTHH:mm:ssZ", "yyyy-MM-ddTHH:mm:ss.fffZ", "dd-MMM-yyyy hh:mm:ss") }
Registry Expiry Date: { Expiration ? : ToDateTimeUtc("yyyy-MM-ddTHH:mm:ss.fZ") }
Expiration Date: { Expiration ? : SubstringBefore("UTC"), ToDateTimeUtc("yyyy-MM-ddTHH:mm:ssZ", "yyyy-MM-ddTHH:mm:ss.fffZ", "dd-MMM-yyyy hh:mm:ss") }
Registrar Registration Expiration Date: { Expiration ? : ToDateTimeUtc("yyyy-MM-ddTHH:mm:ssZ") }

#
# Trademark Info
#
Trademark Name: { Trademark.Name ? }
Trademark Date: { Trademark.Date ? : ToDateTime("yyyy-MM-dd") }
Trademark Country: { Trademark.Country ? }
Trademark Number: { Trademark.Number ? }

#
# Registrar Info
#
Registrar: { Registrar.Name ? }
Registrar IANA ID: { Registrar.IanaId ? : IsNumeric }
Registrar Abuse Contact Email: { Registrar.AbuseEmail ? : IsEmail }
Registrar Abuse Contact Phone: { Registrar.AbuseTelephoneNumber ? : IsPhoneNumber }
Registrar URL: { Registrar.Url ? : IsUrl, ToLower } 
Registrar WHOIS Server: { Registrar.WhoisServerUrl ? : IsDomainName, ToLower }

#
# Supporting Registrar
#
Sponsoring Registrar: { Registrar.Name ? }
Sponsoring Registrar IANA ID: { Registrar.IanaId ? : IsNumeric }
Sponsoring Registrar URL: { Registrar.Url ? : IsUrl, ToLower }
Sponsoring Registrar Phone: { Registrar.AbuseTelephoneNumber ? : IsPhoneNumber }
Sponsoring Registrar Customer Service Contact: { Registrar.AbuseTelephoneNumber ? : IsPhoneNumber }
Sponsoring Registrar Customer Service Email: { Registrar.AbuseEmail ? : IsEmail }

# Alternate form
WHOIS Server: { Registrar.WhoisServerUrl ? : IsDomainName, ToLower } 
Referral URL: { Registrar.Url ? : IsUrl, ToLower } 

#
# Domain Status
#
Domain Status: { DomainStatus ? : Repeating, SubstringBefore(' ') }
Status: { DomainStatus ? : Repeating }
DNSSEC: { DnsSecStatus ? }

#
# Name Servers
#
Name Server: { NameServers ? : IsDomainName, ToLower, Repeating }

#
# Registrant Info
#
Registry Registrant ID: { Registrant.RegistryId ? }
Registrant ID: { Registrant.RegistryId ? }
Registrant Name: { Registrant.Name ? }
Registrant Organization: { Registrant.Organization ? }
Registrant Street: { Registrant.Address ? : IsNotEmpty }
Registrant City: { Registrant.Address ? : IsNotEmpty }
Registrant State/Province: { Registrant.Address ? : IsNotEmpty }
Registrant Postal Code: { Registrant.Address ? : IsNotEmpty }
Registrant Country: { Registrant.Address ? : IsNotEmpty }
Registrant Phone: { Registrant.TelephoneNumber ? : IsPhoneNumber }
Registrant Phone Ext: { Registrant.TelephoneNumberExt ? : IsNumeric }
Registrant Fax: { Registrant.FaxNumber ? : IsPhoneNumber }
Registrant Fax Ext: { Registrant.FaxNumberExt ? : IsNotEmpty, IsNumeric }
Registrant Email: { Registrant.Email ? : IsEmail }

#
# Admin Contact Info
#
Registry Admin ID: { AdminContact.RegistryId ? }
Admin ID: { AdminContact.RegistryId ? }
Admin Name: { AdminContact.Name ? }
Admin Organization: { AdminContact.Organization ? }
Admin Street: { AdminContact.Address ? : IsNotEmpty }
Admin City: { AdminContact.Address ? : IsNotEmpty }
Admin State/Province: { AdminContact.Address ? : IsNotEmpty }
Admin Postal Code: { AdminContact.Address ? : IsNotEmpty }
Admin Country: { AdminContact.Address ? : IsNotEmpty }
Admin Phone: { AdminContact.TelephoneNumber ? : IsPhoneNumber }
Admin Phone Ext: { AdminContact.TelephoneNumberExt  ? : IsNumeric } 
Admin Fax: { AdminContact.FaxNumber ? : IsPhoneNumber } 
Admin Fax Ext: { AdminContact.FaxNumberExt ? : IsNumeric } 
Admin Email: { AdminContact.Email ? : IsEmail }

#
# Tech Contact Info
#
Registry Tech ID: { TechnicalContact.RegistryId  ? }
Tech ID: { TechnicalContact.RegistryId ? }
Tech Name: { TechnicalContact.Name ? }
Tech Organization: { TechnicalContact.Organization ? }
Tech Street: { TechnicalContact.Address ? : IsNotEmpty }
Tech City: { TechnicalContact.Address ? : IsNotEmpty }
Tech State/Province: { TechnicalContact.Address ? : IsNotEmpty }
Tech Postal Code: { TechnicalContact.Address ? : IsNotEmpty }
Tech Country: { TechnicalContact.Address ? : IsNotEmpty }
Tech Phone: { TechnicalContact.TelephoneNumber ? : IsPhoneNumber }
Tech Phone Ext: { TechnicalContact.TelephoneNumberExt ? : IsNumeric } 
Tech Fax: { TechnicalContact.FaxNumber ? : IsPhoneNumber } 
Tech Fax Ext: { TechnicalContact.FaxNumberExt ? : IsNumeric }
Tech Email: { TechnicalContact.Email ? : IsEmail }

#
# Billing Contact Info
#
Registry Billing ID: { BillingContact.RegistryId  ? }
Billing ID: { BillingContact.RegistryId ? }
Billing Name: { BillingContact.Name ? }
Billing Organization: { BillingContact.Organization ? }
Billing Street: { BillingContact.Address ? : IsNotEmpty }
Billing City: { BillingContact.Address ? : IsNotEmpty }
Billing State/Province: { BillingContact.Address ? : IsNotEmpty }
Billing Postal Code: { BillingContact.Address ? : IsNotEmpty }
Billing Country: { BillingContact.Address ? : IsNotEmpty }
Billing Phone: { BillingContact.TelephoneNumber ? : IsPhoneNumber }
Billing Phone Ext: { BillingContact.TelephoneNumberExt ? : IsNumeric }
Billing Fax: { BillingContact.FaxNumber ? : IsPhoneNumber } 
Billing Fax Ext: { BillingContact.FaxNumberExt ? : IsNumeric } 
Billing Email: { BillingContact.Email ? : IsEmail }
